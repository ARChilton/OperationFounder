!function(e){"undefined"!=typeof module&&module.exports?module.exports=e(require("leaflet")):(window.L.control.iconLayers=e(window.L),window.L.Control.IconLayers=window.L.control.iconLayers.Constructor)}(function(e){function t(e,t){for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)}function i(e,t){e.children.length?e.insertBefore(t,e.children[0]):e.appendChild(t)}var a=e.Control.extend({includes:e.Evented?e.Evented.prototype:e.Mixin.Events,_getActiveLayer:function(){return this._activeLayerId?this._layers[this._activeLayerId]:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t}(this._layers)?function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t]}(this._layers):null},_getPreviousLayer:function(){var e=this._getActiveLayer();return e?this._previousLayerId?this._layers[this._previousLayerId]:function(e,t){if(e.length){for(var i=0;i<e.length;i++)if(t(e[i]))return e[i]}else for(var a in e)if(e.hasOwnProperty(a)&&t(e[a]))return e[a]}(this._layers,function(t){return t.id!==e.id}.bind(this))||null:null},_getInactiveLayers:function(){var e=[],i=this._getActiveLayer()?this._getActiveLayer().id:null,a=this._getPreviousLayer()?this._getPreviousLayer().id:null;return t(this._layers,function(t){t.id!==i&&t.id!==a&&e.push(t)}),e},_arrangeLayers:function(){var e={previous:function(){var e=this._getInactiveLayers();return this._getActiveLayer()&&e.unshift(this._getActiveLayer()),this._getPreviousLayer()&&e.unshift(this._getPreviousLayer()),e}};return e[this.options.behavior].apply(this,arguments)},_getLayerCellByLayerId:function(e){for(var t=this._container.getElementsByClassName("leaflet-iconLayers-layerCell"),i=0;i<t.length;i++)if(t[i].getAttribute("data-layerid")==e)return t[i]},_createLayerElement:function(t){var i=e.DomUtil.create("div","leaflet-iconLayers-layer");if(t.title){var a=e.DomUtil.create("div","leaflet-iconLayers-layerTitleContainer"),r=e.DomUtil.create("div","leaflet-iconLayers-layerTitle");r.innerHTML=t.title,a.appendChild(r),i.appendChild(a)}return t.icon&&i.setAttribute("style","background-image: url('"+t.icon+"')"),i},_createLayerElements:function(){for(var t,a,r=this._arrangeLayers(),n=this._getActiveLayer()&&this._getActiveLayer().id,s=0;s<r.length;s++)s%this.options.maxLayersInRow==0&&(t=e.DomUtil.create("div","leaflet-iconLayers-layersRow"),-1===this.options.position.indexOf("bottom")?this._container.appendChild(t):i(this._container,t)),(a=e.DomUtil.create("div","leaflet-iconLayers-layerCell")).setAttribute("data-layerid",r[s].id),0!==s&&e.DomUtil.addClass(a,"leaflet-iconLayers-layerCell_hidden"),r[s].id===n&&e.DomUtil.addClass(a,"leaflet-iconLayers-layerCell_active"),"left"===this._expandDirection?e.DomUtil.addClass(a,"leaflet-iconLayers-layerCell_expandLeft"):e.DomUtil.addClass(a,"leaflet-iconLayers-layerCell_expandRight"),a.appendChild(this._createLayerElement(r[s])),-1===this.options.position.indexOf("right")?t.appendChild(a):i(t,a)},_onLayerClick:function(e){e.stopPropagation();var t=e.currentTarget.getAttribute("data-layerid"),i=this._layers[t];this.setActiveLayer(i.layer),this.expand()},_attachEvents:function(){t(this._layers,function(e){var t=this._getLayerCellByLayerId(e.id);t&&t.addEventListener("click",this._onLayerClick.bind(this))}.bind(this));for(var e=this._container.getElementsByClassName("leaflet-iconLayers-layersRow"),i=function(e){e.stopPropagation(),this.expand()}.bind(this),a=function(e){e.stopPropagation(),this.collapse()}.bind(this),r=function(e){e.stopPropagation()},n=0;n<e.length;n++){var s=e[n];s.addEventListener("mouseenter",i),s.addEventListener("mouseleave",a),s.addEventListener("mousemove",r)}},_render:function(){this._container.innerHTML="",this._createLayerElements(),this._attachEvents()},_switchMapLayers:function(){if(this._map){var e=this._getActiveLayer(),i=this._getPreviousLayer();i?this._map.removeLayer(i.layer):t(this._layers,function(e){var t=e.layer;this._map.removeLayer(t)}.bind(this)),e&&this._map.addLayer(e.layer)}},options:{position:"bottomleft",behavior:"previous",expand:"horizontal",autoZIndex:!0,maxLayersInRow:5,manageLayers:!0},initialize:function(t,i){e.Util.isArray(arguments[0])||(i=t,t=[]),e.setOptions(this,i),this._expandDirection=-1!=this.options.position.indexOf("left")?"right":"left",this.options.manageLayers&&this.on("activelayerchange",this._switchMapLayers,this),this.setLayers(t)},onAdd:function(t){return this._container=e.DomUtil.create("div","leaflet-iconLayers"),e.DomUtil.addClass(this._container,"leaflet-iconLayers_"+this.options.position),this._render(),t.on("click",this.collapse,this),this.options.manageLayers&&this._switchMapLayers(),this._container},onRemove:function(e){e.off("click",this.collapse,this)},setLayers:function(t){this._layers={},t.map(function(t){var i=e.stamp(t.layer);this._layers[i]=e.extend(t,{id:i})}.bind(this)),this._container&&this._render()},setActiveLayer:function(t){var i=t&&this._layers[e.stamp(t)];i&&i.id!==this._activeLayerId&&(this._previousLayerId=this._activeLayerId,this._activeLayerId=i.id,this._container&&this._render(),this.fire("activelayerchange",{layer:t}))},expand:function(){this._arrangeLayers().slice(1).map(function(t){var i=this._getLayerCellByLayerId(t.id);e.DomUtil.removeClass(i,"leaflet-iconLayers-layerCell_hidden")}.bind(this))},collapse:function(){this._arrangeLayers().slice(1).map(function(t){var i=this._getLayerCellByLayerId(t.id);e.DomUtil.addClass(i,"leaflet-iconLayers-layerCell_hidden")}.bind(this))}}),r=function(e,t){return new a(e,t)};return r.Constructor=a,r});